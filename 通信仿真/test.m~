clc;
clear;
close all;

%==================================================
%  统计信号处理-频谱分析
%==================================================
%  对一个以50Hz和120Hz为主要成分的信号进行分析
Fs = 1000;             %采用频率
T=1/Fs;                %采样间隔
L = 1000;              %信号长度
t = (0:L-1)*T;         %时间向量
x  = 0.7*sin(2*pi*50*t) + sin(2*pi*120*t);
y = x+ 2*randn(size(t));
figure(16);
subplot(121);
plot(Fs*t(1:50), y(1:50));
title('原始信号');
xlabel('time(ms)');
NFFT = 2^nextpow2(L);
Y = fft(y,NFFT)/L;
f = Fs/2*linspace(0,1,NFFT/2+1);
subplot(122);
plot(f,2*abs(Y(1:NFFT/2+1)));
subplot(122);
plot(f,2*abs(Y(1:NFFT/2+1)));
title('幅度谱');
xlabel('Frequency(Hz)');
ylabel('|Y(f)|');
